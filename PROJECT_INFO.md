# PROJECT INFO - CRITICAL INFORMATION FOR AI ASSISTANT

**ВАЖНО:** Этот файл содержит критическую информацию о проекте. Всегда учитывай эти данные при работе!

---

## ОСНОВНАЯ ЦЕЛЬ ПРОЕКТА

Написать научную статью для **Scopus Q4** журнала о предсказании уровня PM2.5 в Бишкеке на основе изображений с городских веб-камер.

**Задача:** Regression - предсказать числовое значение PM2.5 (µg/m³) по изображению + метеоданным

---

## КАМЕРЫ (4 активные)

### Используемые камеры:

1. **ala_too_square** ✅ Рекомендуется
   - Координаты: 42.875576, 74.603629
   - URL: https://stream.kt.kg:5443/live/camera25.m3u8
   - Разрешение: 1280x720

2. **ala_too_square_2** ✅ Рекомендуется
   - Координаты: 42.875767, 74.604619
   - URL: https://stream.kt.kg:5443/live/camera27.m3u8
   - Разрешение: 1920x1080

3. **bishkek_panorama** ✅ Рекомендуется
   - Координаты: Неизвестно (требует уточнения)
   - URL: https://stream.kt.kg:5443/live/camera28.m3u8
   - Разрешение: 1920x1080
   - **Идеальная камера** - чистое небо, отличная видимость дымки

4. **sovmin** ✅ Рекомендуется
   - Координаты: 42.804394, 74.587977
   - URL: https://stream.kt.kg:5443/live/camera33.m3u8
   - Разрешение: 1920x1080

### НЕ используемые:

5. **kt_center** ❌ НЕ рекомендуется
   - Координаты: 42.874689, 74.612241
   - URL: https://stream.kt.kg:5443/live/camera35.m3u8
   - **Причина:** Поворотная камера - меняющийся ракурс = проблема для ML

---

## КРИТИЧЕСКИЕ ОГРАНИЧЕНИЯ И ПРОБЛЕМЫ

### ⚠️ 1. Пространственная согласованность (КРИТИЧНО!)

**ПРОБЛЕМА:** Камера и датчик PM2.5 должны быть в одном районе!
- PM2.5 - локальное явление (меняется на расстоянии 1-2 км)
- Камера показывает видимость вдоль линии зрения (5-10 км)
- Если камера и датчик далеко - корреляция будет СЛАБОЙ

**РЕШЕНИЕ:**
- Найти координаты датчиков IQAir/OpenAQ для Бишкека
- Рассчитать расстояние до камер
- Выбрать пары камера-датчик с расстоянием < 1-2 км
- В статье ЧЕТКО описать это ограничение

### ⚠️ 2. Видимость ≠ PM2.5

**ПРОБЛЕМА:** На видимость влияют:
- Влажность (туман, дождь) - снижает видимость БЕЗ PM2.5
- Время суток (темно/светло)
- Погода (облака, дождь)

**РЕШЕНИЕ:**
- Обязательно сравнить Baseline (только метео) vs Image-only vs Multimodal
- Показать, что изображение ДАЁТ ПРИРОСТ, а не только погода
- Ablation study - какие признаки важны

### ⚠️ 3. Малый датасет

**ПРОБЛЕМА:** 1000 изображений - ОЧЕНЬ МАЛО для обучения CNN

**РЕШЕНИЕ:**
- **Transfer Learning** (ImageNet pretrained) - ОБЯЗАТЕЛЬНО
- Заморозить большую часть слоёв
- Data augmentation (но осторожно - не менять признаки дымки)
- Собрать 2000-4000+ изображений (3-6 месяцев сбора)

### ⚠️ 4. Временная синхронизация

**ПРОБЛЕМА:** ±30 минут - слишком широкое окно

**РЕШЕНИЕ:**
- Использовать ±5-10 минут максимум
- Точная синхронизация по timestamp

### ⚠️ 5. Cross-camera generalization

**ПРОБЛЕМА:** Train на camera A → Test на camera B = плохие результаты (domain shift)

**РЕШЕНИЕ:**
- НЕ переоценивать этот эксперимент
- Описать как limitation (модель специфична для конкретной камеры)
- Лучше: mixed dataset (train/test на обеих камерах)

---

## МЕТОДОЛОГИЯ

### Модели:
- **CNN:** ResNet-18 или EfficientNet-B0 (pretrained ImageNet)
- **MLP:** для метео-данных (temperature, humidity, wind_speed, time_of_day)
- **Fusion:** concatenate features → regression head

### Метрики:
- MAE (Mean Absolute Error)
- RMSE (Root Mean Squared Error)
- R² (coefficient of determination)

### Эксперименты (ОБЯЗАТЕЛЬНО):
1. **Baseline:** только метео → PM2.5
2. **Image-only:** только изображение → PM2.5
3. **Multimodal:** изображение + метео → PM2.5
4. **Ablation:** какие признаки важны?
5. **Seasonal analysis:** зима (смог) vs лето (чисто)

---

## ДАННЫЕ PM2.5 - ИСТОЧНИКИ

### 1. OpenAQ API
- URL: https://api.openaq.org
- **Статус:** API v2 deprecated (ошибка 410), нужно обновить на v3
- **Бесплатно:** Да
- **API key:** Не требуется

### 2. IQAir API
- URL: https://www.iqair.com/air-pollution-data-api
- **Бесплатно:** Да (1000 calls/month)
- **API key:** ТРЕБУЕТСЯ (бесплатная регистрация)
- **Данные:** PM2.5 + температура + влажность + ветер

### 3. OpenWeatherMap
- URL: https://openweathermap.org/api
- **Бесплатно:** Да (1000 calls/day)
- **API key:** ТРЕБУЕТСЯ
- **Данные:** PM2.5 + PM10 + полные метеоданные + видимость

---

## СТРУКТУРА ПРОЕКТА

```
research_paper_cv/
├── src/                    # Код
│   ├── camera_config.py    # Конфигурация камер
│   ├── capture_frame.py    # Захват с одной камеры
│   ├── collect_data.py     # Массовый сбор со всех камер
│   └── fetch_pm25_data.py  # Получение PM2.5 данных
├── data/                   # Данные (НЕ коммитить!)
│   ├── images/             # Кадры с камер
│   ├── pm25/               # Данные PM2.5
│   ├── weather/            # Метеоданные
│   └── metadata/           # Метаданные сборов
├── docs/                   # Документация
│   ├── camera_locations.txt
│   └── project_proposal.txt
└── requirements.txt
```

---

## ПЛАН РАБОТЫ

### Фаза 1: Сбор данных (1-3 месяца)
- [ ] Получить API ключи (IQAir, OpenWeatherMap)
- [ ] Найти координаты датчиков PM2.5
- [ ] Рассчитать расстояния камера-датчик
- [ ] Запустить автоматический сбор (каждый час)
- [ ] Собрать 2000-4000+ изображений

### Фаза 2: Подготовка датасета
- [ ] Синхронизация изображений с PM2.5 (±10 мин)
- [ ] Фильтрация (удалить ночные, дождливые, технические проблемы)
- [ ] Нормализация данных
- [ ] Train/val/test split (70/15/15 или 60/20/20)

### Фаза 3: Обучение модели
- [ ] Baseline модель (только метео)
- [ ] Image-only модель (transfer learning)
- [ ] Multimodal модель
- [ ] Ablation studies
- [ ] Hyperparameter tuning

### Фаза 4: Анализ
- [ ] Метрики (MAE, RMSE, R²)
- [ ] Визуализация (predictions vs ground truth)
- [ ] Interpretability (Grad-CAM - на что смотрит модель?)
- [ ] Error analysis (когда модель ошибается?)
- [ ] Seasonal comparison (зима vs лето)

### Фаза 5: Статья
- [ ] Abstract
- [ ] Introduction (актуальность, проблема смога в Бишкеке)
- [ ] Related Work (похожие работы для других городов)
- [ ] Data Collection (описать камеры, датчики, синхронизацию)
- [ ] Methodology (архитектура, transfer learning, multimodal fusion)
- [ ] Experiments (baseline, ablation, seasonal)
- [ ] Results (метрики, графики, визуализации)
- [ ] Discussion (почему работает/не работает, сравнение с другими)
- [ ] Limitations (честно описать ограничения!)
- [ ] Conclusion
- [ ] References

---

## SCIENTIFIC CONTRIBUTIONS (для статьи)

1. **Low-cost monitoring:** Использование существующей инфраструктуры (камер)
2. **Multimodal approach:** Комбинирование визуальных и метео-данных
3. **Case study:** Первое применение для Центральной Азии (Бишкек)
4. **Comparative analysis:** Baseline vs Image vs Multimodal
5. **Interpretability:** Grad-CAM visualization

---

## ВАЖНЫЕ ЗАМЕЧАНИЯ

### Для ML кода:
- **ВСЕГДА** использовать pretrained модели (ImageNet)
- **ВСЕГДА** делать train/val/test split
- **ВСЕГДА** фиксировать random seed (воспроизводимость)
- **ВСЕГДА** сохранять checkpoints
- **ВСЕГДА** логировать эксперименты

### Для статьи:
- **Честно** описывать limitations
- **Чётко** указывать расстояния камера-датчик
- **Показать** что изображение даёт прирост (не только метео)
- **Сравнить** с baseline
- **Не переоценивать** результаты (это Q4 journal, не Nature)

### Для данных:
- **НЕ коммитить** изображения и данные в git
- **НЕ коммитить** API ключи
- **Сохранять** metadata о каждом сборе
- **Бэкапить** данные (жёсткий диск, облако)

---

## ТЕКУЩИЙ СТАТУС (2025-12-26)

✅ **Выполнено:**
- Конфигурация камер
- Скрипты для захвата кадров
- Тестирование всех 4 камер
- Структура проекта
- README.md
- .gitignore

⏳ **В процессе:**
- Получение API ключей для PM2.5
- Обновление fetch_pm25_data.py для OpenAQ v3

❌ **Не начато:**
- Поиск координат датчиков PM2.5
- Непрерывный сбор данных
- Обучение моделей
- Написание статьи

---

## КРИТИЧЕСКИЕ ВОПРОСЫ (ТРЕБУЮТ ОТВЕТА)

1. ❓ **Где находятся датчики PM2.5 в Бишкеке?** (координаты)
2. ❓ **Какое расстояние между камерами и датчиками?** (< 1-2 км?)
3. ❓ **Есть ли корреляция между видимостью и PM2.5?** (проверить вручную на 50 примерах)
4. ❓ **Сколько данных нужно собрать?** (минимум 2000+ изображений)
5. ❓ **Какой целевой журнал?** (выбрать конкретный Scopus Q4 journal)

---

## СЛЕДУЮЩИЕ ШАГИ

1. Получить API ключи (IQAir, OpenWeatherMap)
2. Обновить fetch_pm25_data.py для OpenAQ API v3
3. Найти координаты датчиков PM2.5 в Бишкеке
4. Запустить непрерывный сбор данных (3-6 месяцев)
5. Параллельно: написать baseline код для обучения модели

---

**Дата создания:** 2025-12-26
**Последнее обновление:** 2025-12-26
